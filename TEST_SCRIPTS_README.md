# IsoformX Test Scripts

This directory contains test scripts for validating the IsoformX pipeline with example data.

## Test Scripts

### 1. `test_example_data.sh` - Comprehensive Test Suite
**Full-featured test script with detailed output and validation**

**Features:**
- Tests both elongating and polyadenylation example data
- Filters high-confidence isoforms
- Tests mock data generation
- Performs quality checks (GFF format, sorting)
- Provides detailed summary and next steps

**Usage:**
```bash
./test_example_data.sh
```

**Output:**
- Creates `test_output/` directory with all results
- Detailed progress reporting
- Quality validation checks
- Summary statistics

### 2. `quick_test.sh` - Quick Validation
**Simple script for rapid testing**

**Features:**
- Quick test of all three data types
- Minimal output
- Fast execution

**Usage:**
```bash
./quick_test.sh
```

**Output:**
- Creates `quick_test_*.gff3` files
- Basic statistics only

## Example Data

The test scripts use pre-extracted example datasets:

- **`example_data/13_elongating_6k.bam`** - First 6000 reads from elongating sample
- **`example_data/13_polyadenylation_6k.bam`** - First 6000 reads from polyadenylation sample

## Expected Results

### Elongating Data
- **Input reads**: 6000 (1570 valid after filtering)
- **Expected isoforms**: ~58
- **High-confidence**: ~58 (confidence ≥ 0.6)

### Polyadenylation Data  
- **Input reads**: 6000 (2041 valid after filtering)
- **Expected isoforms**: ~33
- **High-confidence**: ~30 (confidence ≥ 0.6)

### Mock Data
- **Generated reads**: 20-50
- **Expected isoforms**: 1-5

## Quality Checks

The comprehensive test script validates:

1. **GFF Format**: Proper transcript-exon hierarchy
2. **Sorting**: Chromosome and position-based sorting
3. **File Integrity**: All output files created successfully
4. **Statistics**: Isoform counts match expectations

## Troubleshooting

### Common Issues

1. **"command not found: isoformx"**
   ```bash
   conda activate isoformx
   ```

2. **"No reads found"**
   - Check BAM file paths
   - Verify BAM files are not corrupted

3. **"No isoforms found"**
   - Try more relaxed parameters
   - Check read length filters

### Manual Testing

If scripts fail, test manually:

```bash
# Activate environment
conda activate isoformx

# Test single file
isoformx cluster --input example_data/13_elongating_6k.bam --output test.gff3 --verbose

# Check results
head -10 test.gff3
grep -c "transcript" test.gff3
```

## Next Steps

After successful testing:

1. **View in genome browser** (IGV, JBrowse)
2. **Compare with reference annotation**
3. **Analyze isoform characteristics**
4. **Validate high-confidence candidates**
5. **Process full datasets**

## File Structure

```
isoformx/
├── test_example_data.sh      # Comprehensive test script
├── quick_test.sh             # Quick test script
├── example_data/             # Example BAM files
│   ├── 13_elongating_6k.bam
│   └── 13_polyadenylation_6k.bam
└── test_output/              # Generated by comprehensive test
    ├── elongating_isoforms.gff3
    ├── polyadenylation_isoforms.gff3
    ├── elongating_high_conf.gff3
    ├── polyadenylation_high_conf.gff3
    └── mock_isoforms.gff3
```
